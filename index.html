<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"><title>å®£è¨€ä¿±ä¹éƒ¨</title><link rel="icon" href="./images/000.ico" type="image/x-icon"><link rel="shortcut icon" href="./images/000.ico" type="image/x-icon"><script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script><script type="module">import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";
        window.supabase = createClient(
            "https://zdahntyxdcmkmbgjtizc.supabase.co",
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpkYWhudHl4ZGNta21iZ2p0aXpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkwNDM3MjMsImV4cCI6MjA2NDYxOTcyM30.ew3haBr1qN5lSKQ8LWBRqlqrWw99b_s954GGjrK4brc"
        );</script><style>/* @font-face {
        font-family: "Mono";
        font-style: normal;
        font-weight: 400;
        src: url(/_nuxt/fonts/supply_mono.5330c62.woff2) format("woff2")
    } */

        * {
            box-sizing: border-box;
            /* font-family: Unica77LLWeb-Regular, Helvetica Neue, Helvetica, Arial, Lucida Grande, sans-serif; */
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
        }

        html {
            margin: 0;
            padding: 0
        }

        html.lock {
            overflow: hidden
        }

        body {
            font-size: 18px;
            margin: 0;
            padding: 0;
        }


        a {
            -webkit-text-decoration: none;
            text-decoration: none
        }

        a,
        a:focus,
        a:visited {
            color: #010101
        }

        .languages span {
            margin-left: 10px;
            border: 2px black solid;
            box-sizing: border-box;

            font-size: 18px;

        }

        .languages {
            margin-top: -45px;
            position: absolute;
            right: 0;
            margin-left: 20px;
            margin-right: 20px;
        }



        @media(max-width:899px) {

            .languages span {
                margin-left: 10px;
                border: 2px black solid;
                box-sizing: border-box;

                font-size: 18px;

            }

            .languages {
                margin-top: -45px;
                position: absolute;
                right: 0;
                margin-left: 10px;
                margin-right: 10px;
            }

        }</style><link href="/css/styles.2b4c472ffabc86239714.css" rel="stylesheet"></head><body><header class="header"><div class="header__inner"><div class="header__logo"><div class="header__logo-inner"><a href="" data-page="home"><img src="./images/000.jpg" alt="ManifestoClub"></a></div></div><aside class="header__radio"><div class="radio"><div class="radio__upper"><div id="play" class="radio__play"><input type="checkbox" id="playpause" name="check"> <label for="playpause"></label></div><div class="radio__live"></div><div class="header__mob-toggle"><img src="./images/000.jpg"></div></div><div class="radio__lower"><span>PLAYLIST</span> <span>CHAT</span></div></div></aside><nav class="header__nav"><ul><li><a href="" class="">(CD/LP)</a></li><li><a href="" data-page="merch">MERCH</a></li><li><a href="">(Print)</a></li><li><a href="" data-page="event">Event</a></li><li><a href="" data-page="about">About</a></li><li><span id="login-trigger">Login</span></li></ul></nav></div><div class="mobile-nav" id="mobileNav"><nav class="header__nav--mobile"><ul><li><a href="" data-page="home">HOME</a></li><li><a href="" class="">(CD/LP)</a></li><li><a href="" data-page="merch">MERCH</a></li><li><a href="">(PRINT)</a></li><li><a href="" data-page="event">EVENT</a></li><li><a href="" data-page="gallery">GALLERY</a></li><li><a href="" data-page="about">ABOUT</a></li><li><span>LOGIN</span></li></ul></nav></div><div class="cart" data-page="cart" id="cartIcon" style="display: none;">CART(<span id="cartBadge">0</span>)</div></header><main class="main--banner"><section class="page" id="dynamic-content"></section></main><div class="languages"><span>EN</span><span>ä¸­</span></div><div id="auth-modal" class="auth-modal"><div class="auth-modal-container"><div class="auth-modal-header" style="display: block;"><div id="barcode-container"><svg id="barcode"></svg></div></div><div id="login-form"><div class="login-wrapper"><input type="email" id="login-email" class="auth-form-input" placeholder="EMAIL/MANIFESTO"><p id="login-error" class="error-message" style="display: none;"></p></div><div class="password-input-wrapper"><input type="password" id="login-password" class="auth-form-input" placeholder="PASSWORD"> <span class="forgot-password-link">Forgot password?</span></div><p class="auth-form-btn" id="login-button">LOGIN</p><p class="auth-form-toggle signup">NOT A MEMBER YET?<span> SIGN UP</span></p></div><div id="signup-form"><div class="manifesto-wrapper"><input type="manifesto" id="manifesto" class="auth-form-input" placeholder="MANIFESTO" maxlength="30"><div class="check-manifesto check-icon"></div><p id="manifesto-error" class="error-message" style="display: none;"></p></div><div class="email-wrapper"><input type="email" id="signup-email" class="auth-form-input" placeholder="EMAIL"><div class="check-email check-icon"></div><p id="email-error" class="error-message" style="display: none;"></p></div><div class="password-wrapper"><input type="password" id="signup-password" class="auth-form-input" placeholder="PASSWORD"><div class="check-password check-icon"></div><p id="password-error" class="error-message" style="display: none;"></p></div><p class="auth-form-btn" id="signup-button">SIGN UP</p><p class="auth-form-toggle signup">ALREADY A MEMBER? <span>LOGIN</span></p></div><div id="password-reset-form" style="display:none;"><div class="reset-wrapper"><input type="email" id="reset-email" class="auth-form-input" placeholder="EMAIL"><p id="reset-error" class="error-message" style="display: none;"></p></div><p class="auth-form-btn" id="reset-link">SEND RESET LINK</p><p class="auth-form-toggle login">BACK TO LOGIN</p></div><div id="update-password-form" style="display:none;"><input type="email" id="reset-email-display" class="auth-form-input" placeholder="EMAIL" readonly="readonly" onfocus="this.blur()" style="background-color: #f5f5f5; cursor: default;"><div class="reset-password-wrapper"><input type="password" id="new-password" class="auth-form-input" placeholder="NEW PASSWORD"><div class="check-new-password check-icon"></div><p id="update-password-error" class="error-message" style="display: none;"></p></div><div class="confirm-password-wrapper"><input type="password" class="auth-form-input" id="confirm-password" placeholder="CONFIRM PASSWORD"><div class="check-confirm-password check-icon"></div><p id="confirm-password-error" class="error-message" style="display: none;"></p></div><p class="auth-form-btn" id="update-password">UPDATE PASSWORD</p></div><div id="signup-success-form" style="display:none;"><p>Registration Successful!</p><p>Your member code:</p><span id="manifesto-code"></span><div id="barcode-container"><svg id="barcode-success"></svg></div><p>We've sent a verification email to <span id="success-email"></span></p><div class="success-actions"><p class="auth-form-toggle" id="verify-button">Verify Later</p><p class="auth-form-btn" id="resend-button">Resend Verification Email</p></div></div></div></div><script>document.addEventListener('DOMContentLoaded', () => {
            document.addEventListener('click', function (e) {
                const pageLink = e.target.closest('[data-page]');
                if (pageLink) {
                    e.preventDefault();
                    loadPage(pageLink.dataset.page);
                    return;
                }
            })
            loadPage('home');
        })

        document.addEventListener('gesturestart', function (e) {
            e.preventDefault();
        });

        function closeMobileMenu() {
            document.getElementById('mobileNav').style.display = 'none';
        }

// å…¨å±€çŠ¶æ€ç®¡ç†
window.pageLoadManager = {
    loadingPages: new Set(),
    loadedPages: new Set(),
    pageStates: {},
    scriptRegistry: new Map(),
    
    // æ£€æŸ¥é¡µé¢æ˜¯å¦æ­£åœ¨åŠ è½½
    isPageLoading(page) {
        return this.loadingPages.has(page);
    },
    
    // æ ‡è®°é¡µé¢å¼€å§‹åŠ è½½
    startPageLoad(page) {
        this.loadingPages.add(page);
    },
    
    // æ ‡è®°é¡µé¢åŠ è½½å®Œæˆ
    finishPageLoad(page) {
        this.loadingPages.delete(page);
        this.loadedPages.add(page);
    },
    
    // é‡ç½®é¡µé¢çŠ¶æ€
    resetPage(page) {
        this.loadingPages.delete(page);
        this.loadedPages.delete(page);
        delete this.pageStates[page];
    }
};

async function loadPage(page) {
    const content = document.getElementById("dynamic-content");
    if (!content) {
        console.error('Dynamic content container not found');
        return;
    }

    // é˜²æ­¢é‡å¤åŠ è½½åŒä¸€é¡µé¢
    if (window.pageLoadManager.isPageLoading(page)) {
        console.log(`Page ${page} is already loading, skipping...`);
        return;
    }

    // å¦‚æœæ˜¯åŒä¸€é¡µé¢ä¸”å·²å®Œå…¨åŠ è½½ï¼Œç›´æ¥è¿”å›
    if (window.currentPage === page && 
        window.pageLoadManager.loadedPages.has(page) &&
        window[`pageInitialized_${page}`]) {
        console.log(`Page ${page} already loaded and initialized`);
        return;
    }

    try {
        // æ ‡è®°å¼€å§‹åŠ è½½
        window.pageLoadManager.startPageLoad(page);

        // æ¸…ç†å½“å‰é¡µé¢
        await performPageCleanup();

        content.classList.add("fade-out");

        // è·å–HTMLå†…å®¹
        const html = await fetchPageHTML(page);
        
        // è§£æHTML
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');

        // å¤„ç†æ ·å¼
        await handlePageStyles(doc, page);

        // æ›´æ–°é¡µé¢å†…å®¹
        const pageContent = doc.body.innerHTML || html;
        content.innerHTML = pageContent;

        // è®°å½•å½“å‰é¡µé¢
        window.currentPage = page;
        
        // ç­‰å¾…DOMç¨³å®š
        await waitForDOM();
        
        // åŠ è½½å¤–éƒ¨è„šæœ¬
        await loadPageScript(`page-${page}.js`);
        
        // å¤„ç†å†…è”è„šæœ¬ï¼ˆæ–°çš„å®‰å…¨æ–¹å¼ï¼‰
        await handleInlineScriptsSafely(page, doc);

        // æ ‡è®°é¡µé¢åˆå§‹åŒ–å®Œæˆ
        window[`pageInitialized_${page}`] = true;
        window.pageLoadManager.finishPageLoad(page);

        // é¡µé¢ç‰¹å®šåˆå§‹åŒ–
        await handlePageSpecificInit(page);

        console.log(`âœ… Page ${page} loaded successfully`);

    } catch (error) {
        console.error(`âŒ Failed to load page ${page}:`, error);
        content.innerHTML = `<div class="error-page">
            <h2>é¡µé¢åŠ è½½å¤±è´¥</h2>
            <p>é”™è¯¯ä¿¡æ¯: ${error.message}</p>
            <button onclick="loadPage('${page}')">é‡æ–°åŠ è½½</button>
        </div>`;
        
        // æ¸…ç†åŠ è½½çŠ¶æ€
        window.pageLoadManager.resetPage(page);
    } finally {
        content.classList.remove("fade-out");
        closeMobileMenu();
    }
}

// è·å–é¡µé¢HTML
async function fetchPageHTML(page) {
    // æ„å»ºæ­£ç¡®çš„è·¯å¾„
    let htmlPath;
    const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
    
    if (isLocal) {
        htmlPath = `${page}.html`;
    } else {
        // ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„
        const basePath = window.location.pathname.replace('/index.html', '').replace(/\/$/, '');
        htmlPath = `${basePath}/${page}.html`;
    }
    
    console.log(`Fetching HTML from: ${htmlPath}`);
    
    try {
        const response = await fetch(htmlPath);
        if (!response.ok) {
            // å¦‚æœä¸»è·¯å¾„å¤±è´¥ï¼Œå°è¯•å¤‡é€‰è·¯å¾„
            console.warn(`Primary path failed (${response.status}), trying alternative...`);
            const altPath = `./${page}.html`;
            const altResponse = await fetch(altPath);
            if (!altResponse.ok) {
                throw new Error(`Both paths failed. Primary: ${response.status}, Alternative: ${altResponse.status}`);
            }
            return await altResponse.text();
        }
        return await response.text();
    } catch (error) {
        console.error(`Failed to fetch ${htmlPath}:`, error);
        throw error;
    }
}

// ç­‰å¾…DOMç¨³å®š
function waitForDOM() {
    return new Promise(resolve => {
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', resolve, { once: true });
        } else {
            // é¢å¤–ç­‰å¾…ä¸€å¸§ï¼Œç¡®ä¿DOMå®Œå…¨æ¸²æŸ“
            requestAnimationFrame(() => {
                setTimeout(resolve, 50);
            });
        }
    });
}

// å®‰å…¨å¤„ç†å†…è”è„šæœ¬
async function handleInlineScriptsSafely(page, doc) {
    const scripts = doc.querySelectorAll('script');
    
    // å…ˆæ”¶é›†æ‰€æœ‰è„šæœ¬å†…å®¹
    const scriptContents = Array.from(scripts).map((script, index) => ({
        index,
        src: script.src,
        content: script.textContent?.trim(),
        isInline: !script.src && script.textContent?.trim()
    })).filter(s => s.isInline);

    console.log(`Found ${scriptContents.length} inline scripts for page ${page}`);

    // æ£€æŸ¥å…³é”®å‡½æ•°æ˜¯å¦å·²å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è·³è¿‡ç›¸å…³è„šæœ¬
    const criticalFunctions = ['transferToTShirt', 'saveToDraft', 'initCanvasSection'];
    const existingFunctions = criticalFunctions.filter(fn => typeof window[fn] === 'function');
    
    if (existingFunctions.length > 0) {
        console.log(`Critical functions already exist: ${existingFunctions.join(', ')}`);
        console.log(`Skipping inline script execution for page ${page}`);
        return;
    }

    // æ‰§è¡Œè„šæœ¬ï¼ˆåªåœ¨å‡½æ•°ä¸å­˜åœ¨æ—¶ï¼‰
    for (const scriptInfo of scriptContents) {
        await executeScriptSafely(page, scriptInfo);
    }
}

// å®‰å…¨æ‰§è¡Œå•ä¸ªè„šæœ¬
async function executeScriptSafely(page, scriptInfo) {
    const scriptId = `${page}_script_${scriptInfo.index}`;
    
    // æ£€æŸ¥æ˜¯å¦å·²æ‰§è¡Œ
    if (window.pageLoadManager.scriptRegistry.has(scriptId)) {
        console.log(`Script ${scriptId} already executed, skipping`);
        return;
    }

    try {
        console.log(`Executing script ${scriptId}`);
        
        // åˆ›å»ºå®‰å…¨çš„æ‰§è¡Œç¯å¢ƒ
        const safeExecutor = new Function('page', 'scriptId', `
            // é˜²æ­¢é‡å¤æ‰§è¡Œæ£€æŸ¥
            if (window.pageLoadManager && window.pageLoadManager.scriptRegistry.has('${scriptId}')) {
                console.log('Script already executed: ${scriptId}');
                return;
            }
            
            // DOMå®‰å…¨æ£€æŸ¥åŒ…è£…å™¨
            const originalGetElementById = document.getElementById;
            document.getElementById = function(id) {
                const element = originalGetElementById.call(document, id);
                if (!element) {
                    console.warn('Element not found:', id);
                }
                return element;
            };
            
            // æ‰§è¡ŒåŸå§‹è„šæœ¬
            try {
                ${scriptInfo.content}
            } catch (error) {
                console.error('Script execution error:', error);
                throw error;
            } finally {
                // æ¢å¤åŸå§‹æ–¹æ³•
                document.getElementById = originalGetElementById;
            }
        `);
        
        // æ‰§è¡Œè„šæœ¬
        safeExecutor(page, scriptId);
        
        // æ ‡è®°ä¸ºå·²æ‰§è¡Œ
        window.pageLoadManager.scriptRegistry.set(scriptId, {
            page,
            executed: true,
            timestamp: Date.now()
        });
        
    } catch (error) {
        console.error(`Failed to execute script ${scriptId}:`, error);
        // ä¸è¦é˜»æ­¢é¡µé¢åŠ è½½ï¼Œç»§ç»­æ‰§è¡Œå…¶ä»–è„šæœ¬
    }
}

// å¤„ç†é¡µé¢æ ·å¼
async function handlePageStyles(doc, page) {
    const styles = doc.querySelectorAll('style');
    
    // ç§»é™¤å…¶ä»–é¡µé¢çš„æ ·å¼
    const existingStyles = document.querySelectorAll(`style[data-page]`);
    existingStyles.forEach(existing => {
        if (existing.getAttribute('data-page') !== page) {
            existing.remove();
        }
    });

    // æ£€æŸ¥å¹¶æ·»åŠ å½“å‰é¡µé¢æ ·å¼
    const existingStyle = document.querySelector(`style[data-page="${page}"]`);
    if (existingStyle) {
        existingStyle.remove();
    }

    styles.forEach(styleEl => {
        const newStyle = document.createElement('style');
        newStyle.textContent = styleEl.textContent;
        newStyle.setAttribute('data-page', page);
        document.head.appendChild(newStyle);
    });
}

// æ‰§è¡Œé¡µé¢æ¸…ç†ï¼ˆé‡å‘½åé¿å…é€’å½’å†²çªï¼‰
async function performPageCleanup() {
    if (!window.currentPage) return;

    const currentPageName = window.currentPage;
    
    // å®‰å…¨è°ƒç”¨é€šç”¨æ¸…ç†å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨ä¸”ä¸æ˜¯å½“å‰å‡½æ•°ï¼‰
    if (typeof window.cleanupCurrentPage === 'function' && 
        window.cleanupCurrentPage !== performPageCleanup) {
        try {
            console.log('Calling external cleanup function');
            window.cleanupCurrentPage();
        } catch (error) {
            console.error('Error in external cleanup function:', error);
        }
    }

    // è°ƒç”¨é¡µé¢ç‰¹å®šæ¸…ç†å‡½æ•°
    const cleanupFunctions = {
        'merch': 'cleanupMerchPage',
        'content': 'cleanupContentPage', 
        'profile': 'cleanupProfilePage',
        'home': 'cleanupHomePage'
    };

    const cleanupFnName = cleanupFunctions[currentPageName];
    if (cleanupFnName && typeof window[cleanupFnName] === 'function') {
        console.log(`Cleaning up ${currentPageName} page`);
        try {
            window[cleanupFnName]();
        } catch (error) {
            console.error(`Error in cleanup function ${cleanupFnName}:`, error);
        }
    }

    // æ¸…ç†é¡µé¢è„šæœ¬å’ŒçŠ¶æ€
    cleanupPageScripts(currentPageName);
    
    // é‡ç½®é¡µé¢ç®¡ç†å™¨çŠ¶æ€
    window.pageLoadManager.resetPage(currentPageName);
}

// é¡µé¢ç‰¹å®šåˆå§‹åŒ–
async function handlePageSpecificInit(page) {
    // ç­‰å¾…ä¸€å¸§ç¡®ä¿DOMå®Œå…¨ready
    await new Promise(resolve => requestAnimationFrame(resolve));
    
    switch(page) {
        case 'profile':
            setTimeout(() => {
                if (document.getElementById('dynamic-content')) {
                    window.dispatchEvent(new CustomEvent('profilePageLoaded'));
                }
            }, 100);
            break;
            
        case 'gallery':
            setTimeout(() => {
                if (typeof initGallery === 'function') {
                    initGallery();
                } else {
                    console.log('ç­‰å¾…Galleryåˆå§‹åŒ–å‡½æ•°...');
                    const checkGallery = setInterval(() => {
                        if (typeof initGallery === 'function') {
                            clearInterval(checkGallery);
                            initGallery();
                        }
                    }, 100);
                    
                    // 10ç§’ååœæ­¢æ£€æŸ¥
                    setTimeout(() => clearInterval(checkGallery), 10000);
                }
            }, 200);
            break;
            
        case 'content':
            // ç¡®ä¿contenté¡µé¢çš„å…³é”®å…ƒç´ å­˜åœ¨
            const checkContentElements = setInterval(() => {
                const canvas = document.getElementById('canvas');
                const tshirtContainer = document.getElementById('tshirtContainer');
                
                if (canvas && tshirtContainer) {
                    clearInterval(checkContentElements);
                    console.log('Content page elements ready');
                }
            }, 100);
            
            setTimeout(() => clearInterval(checkContentElements), 5000);
            break;
    }
}

// æ”¹è¿›çš„è„šæœ¬æ¸…ç†
function cleanupPageScripts(page) {
    if (!page) return;
    
    console.log(`ğŸ§¹ Cleaning up scripts for page: ${page}`);
    
    // ç§»é™¤é¡µé¢è„šæœ¬
    const pageScript = document.querySelector(`script[data-page-script="page-${page}.js"]`);
    if (pageScript) {
        pageScript.remove();
        console.log(`Removed page script: page-${page}.js`);
    }
    
    // æ¸…ç†åˆå§‹åŒ–çŠ¶æ€
    delete window[`pageInitialized_${page}`];
    
    // æ¸…ç†è„šæœ¬æ³¨å†Œè¡¨ä¸­ç›¸å…³è®°å½•
    if (window.pageLoadManager.scriptRegistry) {
        const scriptsToRemove = [];
        window.pageLoadManager.scriptRegistry.forEach((info, scriptId) => {
            if (info.page === page) {
                scriptsToRemove.push(scriptId);
            }
        });
        
        scriptsToRemove.forEach(scriptId => {
            window.pageLoadManager.scriptRegistry.delete(scriptId);
        });
        
        console.log(`Cleaned ${scriptsToRemove.length} script registry entries`);
    }
    
    // æ¸…ç†é¡µé¢ç‰¹å®šçŠ¶æ€
    if (page === 'content') {
        // é‡ç½®transferç›¸å…³çŠ¶æ€
        window.isTransferring = false;
        window.transferLock = false;
        
        // æ¸…ç†å¯èƒ½çš„é‡å¤å®šä¹‰çš„å‡½æ•°
        const criticalFunctions = ['transferToTShirt', 'saveToDraft', 'initCanvasSection'];
        criticalFunctions.forEach(fn => {
            if (typeof window[fn] === 'function') {
                console.log(`Keeping critical function: ${fn}`);
                // ä¸åˆ é™¤ï¼Œä½†å¯ä»¥é‡ç½®ç›¸å…³çŠ¶æ€
            }
        });
    }
}

// æ”¹è¿›çš„å¤–éƒ¨è„šæœ¬åŠ è½½
function loadPageScript(jsFileName) {
    return new Promise((resolve) => {
        // æ£€æŸ¥å…³é”®å‡½æ•°æ˜¯å¦å·²å­˜åœ¨
        if (jsFileName === 'page-content.js') {
            const criticalFunctions = ['transferToTShirt', 'saveToDraft'];
            const allExist = criticalFunctions.every(fn => typeof window[fn] === 'function');
            
            if (allExist) {
                console.log('All critical functions exist, skipping script reload');
                resolve();
                return;
            }
        }
        
        // ç§»é™¤ç°æœ‰è„šæœ¬
        const existingScript = document.querySelector(`script[data-page-script="${jsFileName}"]`);
        if (existingScript) {
            existingScript.remove();
        }

        const script = document.createElement('script');
        
        // ä¿®å¤è„šæœ¬è·¯å¾„é—®é¢˜
        const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
        
        if (isLocal) {
            script.src = `/js/${jsFileName}`;
        } else {
            // ç”Ÿäº§ç¯å¢ƒè·¯å¾„ä¿®å¤
            const basePath = window.location.pathname.replace('/index.html', '').replace(/\/$/, '');
            script.src = `${basePath}/js/${jsFileName}`;
        }
        
        script.setAttribute('data-page-script', jsFileName);
        
        script.onload = () => {
            console.log(`âœ… Loaded external script: ${jsFileName}`);
            resolve();
        };
        
        script.onerror = () => {
            console.warn(`âš ï¸ Failed to load: ${jsFileName}, trying alternative path...`);
            
            // å°è¯•å¤‡é€‰è·¯å¾„
            script.remove();
            const altScript = document.createElement('script');
            altScript.src = `./js/${jsFileName}`;
            altScript.setAttribute('data-page-script', jsFileName);
            
            altScript.onload = () => {
                console.log(`âœ… Loaded script via alternative path: ${jsFileName}`);
                resolve();
            };
            
            altScript.onerror = () => {
                console.error(`âŒ Failed to load script from all paths: ${jsFileName}`);
                resolve(); // ä¸é˜»æ­¢é¡µé¢åŠ è½½
            };
            
            document.body.appendChild(altScript);
        };
        
        document.body.appendChild(script);
    });
}

// é¡µé¢åˆå§‹åŒ– - è‡ªåŠ¨åŠ è½½homeé¡µé¢
document.addEventListener('DOMContentLoaded', () => {
    console.log('ğŸš€ Page load manager initializing...');
    
    // è®¾ç½®ç‚¹å‡»äº‹ä»¶ç›‘å¬
    document.addEventListener('click', function (e) {
        const pageLink = e.target.closest('[data-page]');
        if (pageLink) {
            e.preventDefault();
            const targetPage = pageLink.dataset.page;
            console.log(`Navigation clicked: ${targetPage}`);
            loadPage(targetPage);
            return;
        }
    });

    // é˜²æ­¢iOSåŒå‡»ç¼©æ”¾
    document.addEventListener('gesturestart', function (e) {
        e.preventDefault();
    });

    // è‡ªåŠ¨åŠ è½½homeé¡µé¢
    console.log('ğŸ  Auto-loading home page...');
    loadPage('home').catch(error => {
        console.error('âŒ Failed to auto-load home page:', error);
        
        // å¦‚æœåŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œé‡è¯•æŒ‰é’®
        const content = document.getElementById("dynamic-content");
        if (content) {
            content.innerHTML = `
                <div class="error-container" style="text-align: center; padding: 50px;">
                    <h2>é¡µé¢åŠ è½½å¤±è´¥</h2>
                    <p>æ— æ³•åŠ è½½é¦–é¡µå†…å®¹</p>
                    <p>é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                    <button onclick="loadPage('home')" style="padding: 10px 20px; margin: 10px; cursor: pointer;">
                        é‡æ–°åŠ è½½é¦–é¡µ
                    </button>
                    <br>
                    <small>å¦‚æœé—®é¢˜æŒç»­ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ</small>
                </div>
            `;
        }
    });
});

function closeMobileMenu() {
    const mobileNav = document.getElementById('mobileNav');
    if (mobileNav) {
        mobileNav.style.display = 'none';
    }
}

// å·¥å…·å‡½æ•°ï¼šæ£€æŸ¥DOMå…ƒç´ æ˜¯å¦å­˜åœ¨
function waitForElement(selector, timeout = 5000) {
    return new Promise((resolve, reject) => {
        const element = document.querySelector(selector);
        if (element) {
            resolve(element);
            return;
        }
        
        const observer = new MutationObserver((mutations) => {
            const element = document.querySelector(selector);
            if (element) {
                observer.disconnect();
                resolve(element);
            }
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
        
        setTimeout(() => {
            observer.disconnect();
            reject(new Error(`Element ${selector} not found within ${timeout}ms`));
        }, timeout);
    });
}

// è°ƒè¯•å‡½æ•°ï¼šæ£€æŸ¥é¡µé¢èµ„æºåŠ è½½çŠ¶æ€
function debugPageResources() {
    console.log('ğŸ” Debugging page resources:');
    console.log('- Current URL:', window.location.href);
    console.log('- Base path:', window.location.pathname);
    console.log('- Host:', window.location.hostname);
    console.log('- Protocol:', window.location.protocol);
    
    // æ£€æŸ¥åŠ¨æ€å†…å®¹å®¹å™¨
    const content = document.getElementById("dynamic-content");
    console.log('- Dynamic content container:', content ? 'âœ… Found' : 'âŒ Missing');
    
    // æ£€æŸ¥å¯¼èˆªæŒ‰é’®
    const homeButton = document.querySelector('[data-page="home"]');
    console.log('- Home button:', homeButton ? 'âœ… Found' : 'âŒ Missing');
    
    // æ£€æŸ¥é¡µé¢ç®¡ç†å™¨çŠ¶æ€
    console.log('- Page load manager:', window.pageLoadManager ? 'âœ… Ready' : 'âŒ Missing');
}</script><script defer="defer" src="/js/vendors.08ee64c9e60251b5d335.js"></script><script defer="defer" src="/js/styles.7aae21adbc8ce89b8327.js"></script><script defer="defer" src="/js/828.dbea81369c5124811a1a.js"></script><script defer="defer" src="/js/33.545769f2acdaaebe9ae3.js"></script><script defer="defer" src="/js/798.b0cf1e47f6c8f7e444c1.js"></script><script defer="defer" src="/js/global.9e411c2b11604bb8b1b6.js"></script></body></html>