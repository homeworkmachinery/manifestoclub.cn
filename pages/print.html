<style data-page="print">* {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }
    
    
    
      
    
            .library-items, .book-items {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
                list-style-type: none;
               
            }
    
           .library-items li, .book-items li{
                position: relative;
                border: 2px solid black;
                overflow: hidden;
                cursor: pointer;
                background: white;
                height: auto;
            }
    
            .library-items img, .book-items img {
    width: 100%;
    height: auto; /* 修改：填满整个容器 */
    object-fit: cover; /* 修改：保持图片比例并覆盖容器 */
    display: block;
    height: calc(100% - 50px); 
    aspect-ratio: 1 / 1;
}

    
         
            .overlay {
                position: relative; 
                bottom: 0;
                left: 0;
                right: 0;
                padding: 10px;
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
                border-top: 2px black solid;
       
            }
    
            .title {
                font-size: 18px;
                margin-bottom: 5px;
            }
    
            .price {
                font-size: 15px;
                color: black;
            }
    
            /* 添加更多商品项的演示样式 */
            .placeholder-img {
                width: 100%;
                height: 200px;
                display: flex;
                align-items: center;
                justify-content: center;
            
                font-size: 24px;
            }
            .retro-console {
                border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
            }
            .library{
                border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
            }
            .taobao{
                margin-top: 20px;
                border: 2px black solid;
                padding: 5px;
            }
          .books{
            margin-top: 20px;
            border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
          }
    
    
            @media(max-width:899px) {
             
                .library-items {
     
                    display: grid;
            grid-template-columns: repeat(2,  1fr);
            
            gap: 10px;
            list-style-type: none;}
    
            .library{
             
                margin-bottom: 10px;
            }
            .books{
            margin-top: 10px;
                margin-bottom: 10px;
          }
          .book-items{
            gap: 10px;
          }
        }</style><link href="/css/styles.c6120c67c82cba3af7ca.css" rel="stylesheet"><body><div class="library"><h1>Home Library</h1><p>My personal library — feel free to read and scan in-house</p></div><div class="section"><ul class="library-items"><li data-id="game" data-type="library"><img src="/images/library/001.png" width="250px"><div class="overlay"><span class="title">GAME</span></div></li><li data-id="culture" data-type="library"><img src="/images/library/004.png" width="250px"><div class="overlay"><span class="title">CULTURE</span></div></li><li data-id="design" data-type="library"><img src="/images/library/002.png" width="250px"><div class="overlay"><span class="title">DESIGN</span></div></li><li data-id="law" data-type="library"><img src="/images/library/003.png" width="250px"><div class="overlay"><span class="title">LAW</span></div></li></ul></div><div class="books"><h1>Self-Published Books</h1><p>Using home printers to produce compact books of all kinds — from chapbooks to catalogs and handy guides</p></div><div class="section"><ul class="book-items"><li data-id="ground-ip" data-type="book"><img src="/images/library/005.png" width="250px"><div class="overlay"><span class="title">GROUND IP</span></div></li><li data-id="shadow-chapbooks" data-type="book"><img src="/images/library/005.png" width="250px"><div class="overlay"><span class="title">SHADOW CHAPBOOKS</span></div></li><li data-id="comics" data-type="book"><img src="/images/library/005.png" width="250px"><div class="overlay"><span class="title">COMICS</span></div></li></ul></div><script defer="defer" src="/js/vendors.59606a4d8afa88538fd5.js"></script><script defer="defer" src="/js/styles.7aae21adbc8ce89b8327.js"></script><script defer="defer" src="/js/global.7c8e3257026b4f300960.js"></script></body><script>(function() {

            console.log('[Library] Page script starting at:', new Date().toISOString());
            
            // 使用唯一的命名空间避免冲突
            const NAMESPACE = 'libraryPage_' + Date.now();
            
            // 清理函数
            function cleanupLibraryPage() {
                console.log('[Library] Cleaning up...');
                
                // 移除所有可能的事件监听器
                const containers = document.querySelectorAll('.library-items, .book-items');
                containers.forEach(container => {
                    // 克隆节点以移除所有事件监听器
                    const newContainer = container.cloneNode(true);
                    container.parentNode.replaceChild(newContainer, container);
                });
                
                // 清理全局变量
                if (window[NAMESPACE]) {
                    delete window[NAMESPACE];
                }
                delete window.cleanupLibraryPage;
            }
            
            // 立即注册清理函数
            window.cleanupLibraryPage = cleanupLibraryPage;
            
            // 先清理
            const existingCleanup = Object.keys(window).find(key => 
                key.startsWith('libraryPage_') && key !== NAMESPACE
            );
            if (existingCleanup) {
                delete window[existingCleanup];
            }
            
            // 处理项目点击 - 使用防抖
            let isProcessing = false;
            
            function handleItemClick(e) {
                // 防止重复处理
                if (isProcessing) {
                    console.log('[Library] Click ignored - already processing');
                    return;
                }
                
                const item = e.target.closest('li[data-id]');
                if (!item) {
                    return;
                }
                
                // 立即阻止事件传播
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                
                isProcessing = true;
                
                // 获取项目数据
                const itemId = item.getAttribute('data-id');
                const itemType = item.getAttribute('data-type');
                
                console.log('[Library] Item clicked:', itemId, itemType);
                
                try {
                    // 清理当前页面
                    if (window.cleanupLibraryPage) {
                        window.cleanupLibraryPage();
                    }
                    
                    // 根据ID导航到对应页面
                    // 如果是law，导航到law.html
                    if (itemId === 'law') {
    // 在导航前先清理 law 页面的旧状态
    if (window.cleanupLawPage) {
        window.cleanupLawPage();
    }
    
    if (window.router && window.router.navigate) {
        window.router.navigate('law');
    } else if (typeof window.loadPage === 'function') {
        window.loadPage('law');
    }
} else if (itemId === 'culture') {
                    // 在导航前先清理 culture 页面的旧状态
                    if (window.cleanupCulturePage) {
                        window.cleanupCulturePage();
                    }
                    
                    if (window.router && window.router.navigate) {
                        window.router.navigate('culture');
                    } else if (typeof window.loadPage === 'function') {
                        window.loadPage('culture');
                    }
                } else if (itemId === 'game') {
                    // 在导航前先清理 game 页面的旧状态
                    if (window.cleanupGamePage) {
                        window.cleanupGamePage();
                    }
                    
                    if (window.router && window.router.navigate) {
                        window.router.navigate('game');
                    } else if (typeof window.loadPage === 'function') {
                        window.loadPage('game');
                    }
                } else if (itemId === 'design') {
                    // 在导航前先清理 design 页面的旧状态
                    if (window.cleanupDesignPage) {
                        window.cleanupDesignPage();
                    }
                    
                    if (window.router && window.router.navigate) {
                        window.router.navigate('design');
                    } else if (typeof window.loadPage === 'function') {
                        window.loadPage('design');
                    }
} else {
                        // 其他项目导航到通用详情页（如果需要）
                        console.log(`Navigate to ${itemId} page (not implemented yet)`);
                        // 可以根据需要添加其他页面的导航
                        isProcessing = false;
                    }
                    
                } catch (error) {
                    console.error('[Library] Navigation error:', error);
                    isProcessing = false;
                }
            }
            
            // 初始化
            function initLibraryPage() {
                console.log('[Library] Initializing...');
                
                // 使用 setTimeout 确保 DOM 完全就绪
                setTimeout(() => {
                    // 获取所有项目容器
                    const libraryContainer = document.querySelector('.library-items');
                    const bookContainer = document.querySelector('.book-items');
                    
                    if (!libraryContainer) {
                        console.error('[Library] Library container not found');
                    }
                    
                    if (!bookContainer) {
                        console.error('[Library] Book container not found');
                    }
                    
                    // 存储处理器引用
                    window[NAMESPACE] = { handleItemClick };
                    
                    // 为两个容器都添加事件监听
                    if (libraryContainer) {
                        libraryContainer.addEventListener('click', handleItemClick, true);
                        console.log('[Library] Event listener attached to library items');
                    }
                    
                    if (bookContainer) {
                        bookContainer.addEventListener('click', handleItemClick, true);
                        console.log('[Library] Event listener attached to book items');
                    }
                    
                    // 重置处理标志
                    isProcessing = false;
                }, 100);
            }
            
            // 确保 DOM 加载完成后初始化
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initLibraryPage);
            } else {
                initLibraryPage();
            }
            
            // 调试信息
            console.log('[Library] Script complete');
        })();</script>