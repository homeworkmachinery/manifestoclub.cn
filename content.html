<style data-page="about">* {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;

    }

    .container {
        max-width: 1400px;
        margin: 0 auto;

    }


    .panel-left,
    .panel-right,
    .product-details {
        width: calc(50% - 20px);
    }

    /* 顶部导航 */
    .nav-header {
        border: 2px solid black;
        padding: 5px;
        margin-bottom: 20px;
        background-color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: calc(100% - 40px);

        position: fixed;
        z-index: 1000;
        top: 100px;

    }

    .nav-header h1 {
        font-size: 24px;
    }

    .back-btn {

        color: black;
        text-decoration: none;
        cursor: pointer;
        font-size: 16px;

    }






    /* 左侧图片区域 */
    .panel-left {
        position: relative;
        aspect-ratio: 1 / 1;
        display: flex;
        align-items: center;
        border: none;
        justify-content: center;
        border: 2px solid black;
        margin-bottom: 20px;
        margin-top: 60px;

    }

    .panel-left img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    /* 右侧信息区域 */
    .panel-right {
        padding: 30px;
        display: flex;
        border: none;
        position: fixed;
        flex-direction: column;
        border: 2px solid black;
        right: 20px;
        top: 160px;
        box-sizing: border-box;
        width: calc(50% - 20px);
    }

    .product-title {
        font-size: 28px;
        font-weight: bold;
        margin-bottom: 10px;
        color: #333;
    }

    .product-year {
        font-size: 16px;
        color: #666;
        margin-bottom: 20px;
    }

    .product-price {
        font-size: 32px;
        font-weight: bold;
        color: black;
        margin-bottom: 20px;
    }

    .product-category {
        margin-bottom: 15px;
    }

    .category-label {
        font-size: 14px;
        color: black;
        margin-bottom: 8px;
    }

    .category-value {
        font-size: 16px;
        padding: 5px;
        display: inline-block;
        border: 2px solid black;
    }

    .add-to-cart-btn {
        width: 100%;
        padding: 10px;
        background-color: black;
        color: white;
        border: none;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 20px;
    }



    .stock-info {
        font-size: 14px;
        color: black;
        margin-bottom: 20px;
    }




    /* 详情区域 */
    .product-details {
        background-color: white;
        border: 2px solid black;
        padding: 5px;
    }

    .details-header {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 2px solid black;
    }

    .details-content {
        line-height: 1.8;
        color: #333;
    }

    .details-content img {
        width: 100%;
        max-width: 100%;
        height: auto;
        display: block;

    }


    .details-content h3 {
        font-size: 18px;
        margin: 15px 0 15px 0;
        color: black;
    }

    .details-content p {
        margin-bottom: 15px;
        font-size: 16px;
    }

    .details-content ul {
        margin-left: 20px;
        margin-bottom: 20px;
    }

    .details-content li {
        margin-bottom: 10px;
        font-size: 15px;
    }

    .detail-images {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .detail-images img {
        width: 100%;
        height: auto;

    }


    /* 响应式设计 */
    @media (max-width: 768px) {
        .panels {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .panels-right {
            padding: 20px;
        }

        .product-title {
            font-size: 24px;
        }

        .product-price {
            font-size: 28px;
        }

        .product-details {
            padding: 20px;
        }

        .detail-images {
            grid-template-columns: 1fr;
        }
    }</style><link href="/css/styles.8d9e0d4240f2ef45001f.css" rel="stylesheet"><body><div class="container"><div class="nav-header"><h1>PRODUCT DETAILS</h1><a data-page="merch" class="back-btn">← BACK TO SHOP</a></div><div class="panel-left"><img id="mainImage" src="" alt="Product Image"></div><div class="panel-right"><h2 class="product-title" id="productName">Loading...</h2><p class="product-year" id="productYear">-</p><div class="product-price" id="productPrice">$0</div><div class="stock-info">✓ In Stock - Ready to Ship</div><button class="add-to-cart-btn" id="addToCartBtn">ADD TO CART</button><div class="product-category"><div class="category-label">CATEGORY</div><span class="category-value" id="productCategory">Console</span></div></div><div class="product-details"><div class="details-content" id="productDetails"></div></div></div><script>(function () {
            // 产品数据库
            const productDatabase = {
                '1': {
                    name: 'The Spectrum Console',
                    year: '1982-2014',
                    price: '¥1450',
                    category: 'Retro Gaming Console',
                    description: `
                <img src="images/merch/details/default-header.png" >
                <img src="images/merch/details/1-1.avif" >
                <img src="images/merch/details/1-2.webp" >
                <img src="images/merch/details/1-3.jpg" >
                <img src="images/merch/details/1-4.avif" >
                <img src="images/merch/details/1-5.avif" >
                <img src="images/merch/details/1-6.avif" >
            `
                },
                '2': {
                    name: 'Atari 2600+ Console & Joystick',
                    year: '1977-2013',
                    price: '¥1580',
                    category: 'Retro Gaming Console',
                    description: `
            <img src="images/merch/default-header.png" alt="Detail">
                <img src="images/merch/details/2-1.avif" alt="Detail">
                <img src="images/merch/details/2-2.jpg" alt="Detail">
            `
                },
                '3': {
                    name: 'Atari 7800+ Console',
                    year: '1986-2014',
                    price: '¥1450',
                    category: 'Retro Gaming Console',
                    description: `
                <img src="images/merch/details/3-1.jpg" alt="Detail">
                <img src="images/merch/details/3-2.jpg" alt="Detail">
            `
                }
            };

            // 加载产品信息
            function loadProduct() {
                console.log('Loading product information...');
    
    let productId = null;
    
    // 从 sessionStorage 获取
    const pendingData = sessionStorage.getItem('pendingProduct');
    if (pendingData) {
        try {
            const productData = JSON.parse(pendingData);
            productId = productData.id;
            console.log('Got product from pendingProduct:', productId);
            // 清除已使用的数据
            sessionStorage.removeItem('pendingProduct');
        } catch (e) {
            console.error('Failed to parse pending product:', e);
        }
    }
    
    if (!productId) {
        console.warn('No product ID found, defaulting to product 1');
        productId = '1';
    }
    
    console.log('Final product ID:', productId);

                const product = productDatabase[productId];

                if (!product) {
                    console.error('Product not found in database:', productId);
                    document.getElementById('productName').textContent = 'Product Not Found';
                    document.getElementById('productDetails').innerHTML = '<p>Sorry, this product could not be found.</p>';
                    return;
                }

                console.log('Loading product:', product.name);

                // 更新页面内容
                document.getElementById('mainImage').src = `images/merch/${productId}.jpg`;
                document.getElementById('mainImage').alt = product.name;
                document.getElementById('productName').textContent = product.name;
                document.getElementById('productYear').textContent = product.year;
                document.getElementById('productPrice').textContent = product.price;
                document.getElementById('productCategory').textContent = product.category;
                document.getElementById('productDetails').innerHTML = product.description;

                // 更新页面标题
                document.title = `${product.name} - Product Details`;

                // 存储当前产品信息供 addToCart 使用
                window.currentProduct = {
                    ...product,
                    id: productId
                };
            }

            // 添加到购物车功能
            async function handleAddToCart() {
                try {
                    if (!window.currentProduct) {
                        alert('产品信息未加载');
                        return;
                    }

                    const product = window.currentProduct;

                    // 检查 CartManager 是否存在
                    if (!window.CartManager || !window.CartManager.addOrUpdateCartItem) {
                        console.error('CartManager not available');
                        alert('购物车功能暂时不可用');
                        return;
                    }

                    // 检查用户登录状态
                    if (window.supabase) {
                        const { data: { user } } = await supabase.auth.getUser();
                        if (!user) {
                            alert('请先登录');
                            loadPage('login'); // 跳转到登录页
                            return;
                        }

                        // 准备商品数据
                        const priceNumber = parseFloat(product.price.replace(/[^0-9.]/g, ''));

                        const result = await window.CartManager.addOrUpdateCartItem({
                            draftId: `console-${product.id}`,
                            itemData: {
                                type: 'retro-console',
                                title: product.name,
                                unitPrice: priceNumber,
                                category: product.category
                            },
                            sizes: { 'default': 1 },
                            userId: user.id
                        });

                        if (result.success) {
                            const btn = document.getElementById('addToCartBtn');
                            btn.textContent = '✓ 已添加到购物车';
                            btn.style.backgroundColor = '#28a745';

                            setTimeout(() => {
                                btn.textContent = 'ADD TO CART';
                                btn.style.backgroundColor = 'black';
                            }, 2000);

                            if (window.CartManager.showCartAddedEffect) {
                                window.CartManager.showCartAddedEffect();
                            }
                        } else {
                            alert('添加失败: ' + (result.error || '未知错误'));
                        }
                    } else {
                        // 如果没有 supabase，使用简单的本地存储
                        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
                        cart.push({
                            id: product.id,
                            name: product.name,
                            price: product.price,
                            quantity: 1
                        });
                        localStorage.setItem('cart', JSON.stringify(cart));
                        alert('已添加到购物车！');
                    }

                } catch (error) {
                    console.error('Add to cart failed:', error);
                    alert('操作失败，请重试');
                }
            }

            // 页面初始化
            loadProduct();

            // 绑定添加到购物车按钮
            const addBtn = document.getElementById('addToCartBtn');
            if (addBtn) {
                addBtn.addEventListener('click', handleAddToCart);
            }

            // 绑定返回按钮
            const backBtn = document.querySelector('.back-btn');
            if (backBtn) {
                backBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    if (typeof loadPage === 'function') {
                        loadPage('merch');
                    }
                });
            }
        })();</script><script defer="defer" src="/js/vendors.08ee64c9e60251b5d335.js"></script><script defer="defer" src="/js/styles.7aae21adbc8ce89b8327.js"></script><script defer="defer" src="/js/828.8b54376f466bff1ed26f.js"></script><script defer="defer" src="/js/33.35a9cbc4d6d44da6a2b5.js"></script><script defer="defer" src="/js/798.b0cf1e47f6c8f7e444c1.js"></script><script defer="defer" src="/js/global.9e411c2b11604bb8b1b6.js"></script></body>