(()=>{"use strict";var e,t={15230:(e,t,n)=>{var r=n(5773),a=n(39653),s=n(56213),o=n(34963),i=n(44828),c=n.n(i),l=n(11265),u=n.n(l),d=n(56255),p=n.n(d),m=n(54929),y=n.n(m),f=n(18979),g=n.n(f),v=n(61240),h=n.n(v),w=n(29550),b=n.n(w),E=n(11393),x=n.n(E),k=n(74707),I=n.n(k),B=n(15413),L=n.n(B),C=n(86226),S=n.n(C),A=n(66512),T=n.n(A),M=n(8628),O=n.n(M),P=n(49763),_=n.n(P),q=n(48079),U=n.n(q),D=n(86129),H=n.n(D);function N(){var e,t,n,r=document.getElementById("manifesto"),a=(e=(0,o.A)(c().mark(function e(){var t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=u()(t=this.value).call(t))){e.next=2;break}return e.next=1,R(n);case 1:e.next=3;break;case 2:return e.next=3,R("MANIFESTOCLUB");case 3:case"end":return e.stop()}},e,this)})),t=300,function(){var r=this,a=arguments;clearTimeout(n),n=p()(function(){e.apply(r,a)},t)});r.addEventListener("input",a)}function R(e){return F.apply(this,arguments)}function F(){return F=(0,o.A)(c().mark(function e(t){var n,r,a,s,o,i=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:"barcode",r="ManifestoClub",a="MANIFESTOCLUB",!t||"MANIFESTOCLUB"===t){e.next=2;break}return e.next=1,j(t);case 1:s=e.sent,r=g()(s).call(s,0,15),a=s,e.next=4;break;case 2:return e.next=3,j("MANIFESTOCLUB");case 3:a=e.sent;case 4:try{(o=document.getElementById(n)).innerHTML="",H(),H()(o,a,{format:"CODE128",displayValue:!0,text:r,font:'"Lucida Console"',width:2,height:80,margin:0}),o.setAttribute("data-barcode",a)}catch(e){}return e.abrupt("return",a);case 5:case"end":return e.stop()}},e)})),F.apply(this,arguments)}function j(e){return V.apply(this,arguments)}function V(){return(V=(0,o.A)(c().mark(function e(t){var n,r,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof crypto||!crypto.subtle){e.next=4;break}return e.prev=1,n=new TextEncoder,r=n.encode(t),e.next=2,crypto.subtle.digest("SHA-256",r);case 2:return a=e.sent,s=_()(new Uint8Array(a)),o=U()(s).call(s,function(e){var t;return y()(t=e.toString(16)).call(t,2,"0")}).join(""),e.abrupt("return",g()(o).call(o,0,15));case 3:return e.prev=3,e.catch(1),e.abrupt("return",z(t));case 4:return e.abrupt("return",z(t));case 5:case"end":return e.stop()}},e,null,[[1,3]])}))).apply(this,arguments)}function z(e){for(var t,n=0,r=e+"MANIFESTOCLUB_SALT",a=0;a<r.length;a++){n=(n<<5)-n+r.charCodeAt(a),n&=n}for(var s=Math.abs(n),o=y()(t=s.toString(16)).call(t,8,"0");o.length<15;)o+=s.toString(16);return g()(o).call(o,0,15)}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return new(h())(function(n,r){var a=document.getElementById(e);if(a)n(a);else{var s=b()(),o=function(){var a,i=document.getElementById(e);i?n(i):b()()-s>t?r(new Error(x()(a="Element ".concat(e," not found within ")).call(a,t,"ms"))):p()(o,50)};o()}})}window.addEventListener("load",function(){R("MANIFESTOCLUB"),N()});var $=new(function(){return(0,s.A)(function e(){(0,a.A)(this,e),this.cache=new(I()),this.isReady=!0},[{key:"generateBarcodeImage",value:(n=(0,o.A)(c().mark(function e(t,n){var r,a,s,o=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:"member-barcode-complete",e.prev=1,e.next=2,G(r,5e3);case 2:return a=e.sent,e.next=3,this.createBarcodeCanvas(t,n,a);case 3:return s=e.sent,a&&s&&(a.style.width="100%",a.style.height="auto",a.style.objectFit="contain",a.style.display="block"),e.abrupt("return",s);case 4:e.prev=4,e.catch(1);case 5:case"end":return e.stop()}},e,this,[[1,4]])})),function(e,t){return n.apply(this,arguments)})},{key:"createBarcodeCanvas",value:(t=(0,o.A)(c().mark(function e(t,n,r){var a,s,o,i,l,u,d,p,m,y;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=x()(a="barcode_".concat(t,"_")).call(a,n),!this.cache.has(s)){e.next=1;break}return o=this.cache.get(s),r.src=o,r.style.display="block",e.abrupt("return",o);case 1:return e.prev=1,i=document.createElement("canvas"),l=i.getContext("2d"),i.width=1500,i.height=800,l.fillStyle="#000000",l.font=" 90px Arial, sans-serif",l.textAlign="center",l.fillText(t,i.width/2,120),(u=document.createElement("canvas")).width=1400,u.height=500,u.getContext("2d").clearRect(0,0,u.width,u.height),H()(u,n,{format:"CODE128",displayValue:!0,width:10,height:300,margin:50,background:"transparent",font:'"Lucida Console"',fontSize:100}),d=(i.width-u.width)/2,l.drawImage(u,d,110),p=i.toDataURL("image/png"),this.cache.size>50&&(y=L()(m=this.cache).call(m).next().value,this.cache.delete(y)),this.cache.set(s,p),r.src=p,r.style.display="block",e.abrupt("return",p);case 2:return e.prev=2,e.catch(1),e.abrupt("return",null);case 3:case"end":return e.stop()}},e,this,[[1,2]])})),function(e,n,r){return t.apply(this,arguments)})},{key:"preloadBarcode",value:(e=(0,o.A)(c().mark(function e(t,n){var r,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=x()(r="barcode_".concat(t,"_")).call(r,n),this.cache.has(a)){e.next=1;break}return s=document.createElement("img"),e.next=1,this.createBarcodeCanvas(t,n,s);case 1:case"end":return e.stop()}},e,this)})),function(t,n){return e.apply(this,arguments)})}]);var e,t,n}());function K(){return W.apply(this,arguments)}function W(){return(W=(0,o.A)(c().mark(function e(){var t,n,r,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"undefined"!=typeof supabase){e.next=1;break}return e.abrupt("return");case 1:return e.next=2,supabase.auth.getUser();case 2:if(t=e.sent,n=t.data.user){e.next=3;break}return e.abrupt("return");case 3:return e.next=4,supabase.from("profiles").select("manifesto, barcode").eq("user_id",n.id).single();case 4:if(r=e.sent,a=r.data,!r.error){e.next=5;break}return e.abrupt("return");case 5:if(!a||!a.barcode){e.next=7;break}return e.next=6,$.generateBarcodeImage(a.manifesto||"No manifesto",a.barcode,"member-barcode-complete");case 6:case 7:e.next=9;break;case 8:e.prev=8,e.catch(0);case 9:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function Y(){return(Y=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,R("MANIFESTOCLUB");case 1:return N(),e.next=2,J();case 2:if(t=window.location.hash,!O()(t).call(t,"access_token")&&!O()(t).call(t,"refresh_token")){e.next=4;break}return e.next=3,supabase.auth.getSession();case 3:n=e.sent,r=n.data,n.error||r.session&&(a=new(T())(window.location.search),s="password_update"===a.get("type"),o=a.get("email"),s&&o&&ke(decodeURIComponent(o))),window.history.replaceState({},"",window.location.pathname);case 4:be(),Se(),e.next=6;break;case 5:e.prev=5,e.catch(0);case 6:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}function J(){return Q.apply(this,arguments)}function Q(){return(Q=(0,o.A)(c().mark(function e(){var t,n,r,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,supabase.auth.getUser();case 1:t=e.sent,n=t.data.user,r=document.querySelector(".header__nav li:last-child"),n?(r.innerHTML='\n      <div class="user-menu">\n        <span class="user-menu-trigger">(ME)</span>\n        <div class="user-dropdown" id="user-dropdown" style="display: none;">\n          <div class="user-info">\n            <a class="profile" href="profile" data-page="profile">Profile</a>\n          </div>\n          <div class="user-actions">\n            <span class="logout-btn">LOGOUT</span>\n          </div>\n        </div>\n      </div>\n    ',p()((0,o.A)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,K();case 1:case"end":return e.stop()}},e)})),100)):(r.innerHTML='<span id="login-trigger">Login</span>',(a=document.getElementById("member-barcode-complete"))&&(a.style.display="none",a.src=""));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(){return Z.apply(this,arguments)}function Z(){return(Z=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("manifesto"),r=document.querySelector(".check-manifesto"),(a=document.getElementById("manifesto-error")).style.display="none",r.innerHTML="",u()(t=n.value).call(t)){e.next=1;break}return a.textContent="Please enter your manifesto",a.style.display="block",e.abrupt("return",!1);case 1:return e.next=2,ee(n.value);case 2:return s=e.sent,(o=r.querySelector("img"))||((o=document.createElement("img")).alt=s?"Valid":"Invalid",r.appendChild(o)),s?(o.src="/images/yes.png",a.style.display="none"):(o.src="/images/no.png",a.textContent="This manifesto already exists",a.style.display="block"),e.abrupt("return",s);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=(0,o.A)(c().mark(function e(t){var n,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u()(t).call(t)){e.next=1;break}return e.abrupt("return",!1);case 1:return e.next=2,supabase.from("profiles").select("manifesto").eq("manifesto",t);case 2:if(n=e.sent,r=n.data,!n.error){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",0===r.length);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ne(){return re.apply(this,arguments)}function re(){return(re=(0,o.A)(c().mark(function e(){var t,n,r,a,s;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("signup-email"),n=document.querySelector(".check-email"),r=document.getElementById("email-error"),n.innerHTML="",r.style.display="none",e.next=1,ae(t.value);case 1:if((a=e.sent).valid){e.next=7;break}s=a.reason,e.next="empty"===s?2:"invalid_format"===s?3:"registered"===s?4:5;break;case 2:return e.abrupt("return",!1);case 3:return r.textContent="Please enter a valid email address",e.abrupt("continue",6);case 4:return r.textContent="This email is already registered",e.abrupt("continue",6);case 5:r.textContent="Validation error";case 6:return r.style.display="block",n.innerHTML='<img src="/images/no.png" alt="Invalid">',e.abrupt("return",!1);case 7:return n.innerHTML='<img src="/images/yes.png" alt="Valid">',e.abrupt("return",!0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ae(e){return se.apply(this,arguments)}function se(){return(se=(0,o.A)(c().mark(function e(t){var n,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u()(t).call(t)){e.next=1;break}return e.abrupt("return",{valid:!1,reason:"empty"});case 1:if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){e.next=2;break}return e.abrupt("return",{valid:!1,reason:"invalid_format"});case 2:return e.next=3,supabase.from("profiles").select("email").eq("email",t);case 3:if(n=e.sent,r=n.data,!n.error){e.next=4;break}return e.abrupt("return",{valid:!1,reason:"error"});case 4:return e.abrupt("return",{valid:0===r.length,reason:0===r.length?"available":"registered"});case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function oe(){return ie.apply(this,arguments)}function ie(){return(ie=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("signup-password"),r=document.querySelector(".check-password"),a=document.getElementById("password-error"),r.innerHTML="",a.style.display="none",0!==(s=u()(t=n.value).call(t)).length){e.next=1;break}return e.abrupt("return",!1);case 1:return(o=s.length>=8)?r.innerHTML='<img src="/images/yes.png" alt="Valid">':(r.innerHTML='<img src="/images/no.png" alt="Invalid">',a.textContent="Password must be longer than 8 characters",a.style.display="block"),e.abrupt("return",o);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ce(){return le.apply(this,arguments)}function le(){return(le=(0,o.A)(c().mark(function e(){var t,n,a,s,o,i,l,u,d,m,y,f,g,v,w;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,h().all([X(),ne(),oe()]);case 1:if(t=e.sent,n=(0,r.A)(t,3),a=n[0],s=n[1],o=n[2],a&&s&&o){e.next=2;break}return i=function(e){e.style.display="none",p()(function(){return e.style.display="block"},10)},a||(i(document.getElementById("manifesto-error")),document.getElementById("manifesto").focus()),s||(i(document.getElementById("email-error")),document.getElementById("signup-email").focus()),o||(i(document.getElementById("password-error")),document.getElementById("signup-password").focus()),e.abrupt("return");case 2:return l=document.getElementById("signup-email").value,u=document.getElementById("signup-password").value,d=document.getElementById("manifesto").value,e.next=3,R(d);case 3:return m=e.sent,e.next=4,supabase.auth.signUp({email:l,password:u,options:{data:{manifesto:d,barcode:m}}});case 4:if(y=e.sent,f=y.data,!(g=y.error)){e.next=5;break}throw g;case 5:return e.next=6,supabase.from("profiles").upsert({user_id:f.user.id,email:l,manifesto:d,barcode:m,created_at:new Date});case 6:if(v=e.sent,!(w=v.error)){e.next=7;break}throw w;case 7:ue({email:l,manifesto:d});case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ue(e){document.querySelector(".auth-modal-header").style.display="none",document.getElementById("login-form").style.display="none",document.getElementById("signup-form").style.display="none",document.getElementById("password-reset-form").style.display="none",document.getElementById("signup-success-form").style.display="block",document.getElementById("manifesto-code").textContent=e.manifesto,document.getElementById("success-email").textContent=e.email,R(e.manifesto,"barcode-success")}function de(){return pe.apply(this,arguments)}function pe(){return(pe=(0,o.A)(c().mark(function e(){var t,n,r,a;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("success-email").textContent,n=document.getElementById("resend-button"),e.prev=1,n.disabled=!0,n.textContent="Sending...",e.next=2,new(h())(function(e){return p()(e,50)});case 2:return e.next=3,supabase.auth.resend({type:"signup",email:t});case 3:if(r=e.sent,!(a=r.error)){e.next=4;break}throw a;case 4:n.textContent="✓ Email Resent",e.next=6;break;case 5:e.prev=5,e.catch(1),n.textContent="Resend Verification Email",n.disabled=!1;case 6:case"end":return e.stop()}},e,null,[[1,5]])}))).apply(this,arguments)}function me(){document.getElementById("auth-modal").style.display="none",ye()}function ye(){var e,t;document.querySelector(".auth-modal-header").style.display="block",document.getElementById("login-form").style.display="block",document.getElementById("signup-form").style.display="none",document.getElementById("signup-success-form").style.display="none",document.getElementById("password-reset-form").style.display="none",document.getElementById("signup-email").value="",document.getElementById("signup-password").value="",document.getElementById("manifesto").value="",document.getElementById("login-email").value="",document.getElementById("login-password").value="",S()(e=document.querySelectorAll(".check-icon")).call(e,function(e){e.innerHTML=""}),S()(t=document.querySelectorAll(".error-message")).call(t,function(e){e.style.display="none"}),R("MANIFESTOCLUB")}function fe(){document.getElementById("login-form").style.display="none",document.getElementById("password-reset-form").style.display="block"}function ge(){document.getElementById("login-form").style.display="block",document.getElementById("signup-form").style.display="none",document.getElementById("password-reset-form").style.display="none",document.getElementById("update-password-form").style.display="none"}function ve(){document.getElementById("login-form").style.display="none",document.getElementById("signup-form").style.display="block"}document.addEventListener("visibilitychange",function(){document.hidden||"profile"!==window.currentPage||p()((0,o.A)(c().mark(function e(){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,K();case 1:case"end":return e.stop()}},e)})),100)}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".member-code-container");e&&(e.style.width="100%",e.style.boxSizing="border-box");var t=document.querySelector(".barcode-wrapper");t&&(t.style.width="100%")}),document.addEventListener("DOMContentLoaded",function(){return Y.apply(this,arguments)}),"undefined"!=typeof window&&(window.barcodeGenerator=$,window.generateBarcode=R),window.openAuthModal=function(){var e=document.getElementById("auth-modal");if(e){e.style.display="block";var t=sessionStorage.getItem("resetEmail"),n=new(T())(window.location.search),r="password_update"===n.get("type"),a=n.get("email");r&&a?(ke(decodeURIComponent(a)),window.history.replaceState({},document.title,window.location.pathname)):t?ke(t):n.has("login")&&ge()}},window.handleModalClick=function(e){e.target===document.getElementById("auth-modal")&&(document.getElementById("auth-modal").style.display="none",ye())};var he,we=sessionStorage.getItem("resetEmail")||"";function be(){var e=new(T())(window.location.search),t=e.get("email"),n="password_update"===e.get("type");t&&n&&(we=decodeURIComponent(t),sessionStorage.setItem("resetEmail",we),ke(we),window.history.replaceState({},"",window.location.pathname))}function Ee(){return xe.apply(this,arguments)}function xe(){return(xe=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o,i,l,d,m;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u()(t=document.getElementById("reset-email").value).call(t),r=document.getElementById("reset-link"),(a=document.getElementById("reset-error")).style.display="none",a.textContent="",n){e.next=1;break}return a.textContent="Please enter your email address",a.style.display="block",e.abrupt("return");case 1:if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)){e.next=2;break}return a.textContent="Please enter a valid email address",a.style.display="block",e.abrupt("return");case 2:return e.prev=2,r.disabled=!0,r.textContent="Sending...",e.next=3,supabase.from("profiles").select("email").eq("email",n).single();case 3:if(i=e.sent,l=i.data,!i.error&&l){e.next=4;break}throw a.textContent="This email is not registered",a.style.display="block",new Error("Email not registered");case 4:return e.next=5,supabase.auth.resetPasswordForEmail(n,{redirectTo:x()(s=x()(o="".concat(window.location.origin)).call(o,window.location.pathname,"?type=password_update&email=")).call(s,encodeURIComponent(n))});case 5:if(d=e.sent,!(m=d.error)){e.next=6;break}throw m;case 6:r.textContent="✓ Email Sent",sessionStorage.setItem("resetEmail",n),p()(function(){r.textContent="SEND RESET LINK",r.disabled=!1},3e3),e.next=8;break;case 7:e.prev=7,e.catch(2),a.textContent="Failed to send reset link. Please try again.",a.style.display="block",r.textContent="SEND RESET LINK",r.disabled=!1;case 8:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function ke(e){document.getElementById("login-form").style.display="none",document.getElementById("signup-form").style.display="none",document.getElementById("password-reset-form").style.display="none",document.getElementById("update-password-form").style.display="block",document.getElementById("reset-email-display").value=e,document.getElementById("new-password").value="",document.getElementById("confirm-password").value="",document.getElementById("update-password-error").style.display="none",document.getElementById("confirm-password-error").style.display="none",Ie()}function Ie(){var e=document.getElementById("new-password").value,t=document.getElementById("confirm-password").value,n=document.querySelector(".check-new-password"),r=document.querySelector(".check-confirm-password"),a=document.getElementById("update-password-error"),s=document.getElementById("confirm-password-error"),o=document.getElementById("update-password");a.style.display="none",s.style.display="none",n.innerHTML="",r.innerHTML="";var i=!0;return e.length>0&&e.length<8?(Be(n,!1),a.textContent="Password must be at least 8 characters",a.style.display="block",i=!1):e.length>=8&&Be(n,!0),e&&t&&e!==t?(Be(r,!1),s.textContent="Passwords do not match",s.style.display="block",i=!1):t&&e===t&&Be(r,!0),o.disabled=!i,i}function Be(e,t){e.innerHTML="";var n=document.createElement("img");n.src=t?"/images/yes.png":"/images/no.png",n.alt=t?"Valid":"Invalid",e.appendChild(n)}function Le(){return Ce.apply(this,arguments)}function Ce(){return(Ce=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o,i,l,u,d;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ie()){e.next=1;break}return e.abrupt("return");case 1:return t=document.getElementById("new-password").value,n=document.getElementById("update-password"),r=document.getElementById("update-password-error"),e.prev=2,n.disabled=!0,n.textContent="Updating...",e.next=3,supabase.auth.getSession();case 3:if(a=e.sent,s=a.data.session,!a.error&&s){e.next=4;break}throw new Error("Your password reset link has expired. Please request a new one.");case 4:return e.next=5,supabase.auth.updateUser({password:t});case 5:if(o=e.sent,!(i=o.error)){e.next=6;break}throw i;case 6:n.textContent="✓ Password Updated",sessionStorage.removeItem("resetEmail"),p()(function(){ge(),document.getElementById("new-password").value="",document.getElementById("confirm-password").value="",alert("Password updated successfully! Please log in with your new password.")},1500),e.next=8;break;case 7:e.prev=7,d=e.catch(2),r.textContent=O()(l=d.message).call(l,"expired")||O()(u=d.message).call(u,"Auth session missing")?"Your password reset link has expired. Please request a new one.":"Error: ".concat(d.message),r.style.display="block",n.textContent="UPDATE PASSWORD",n.disabled=!1;case 8:case"end":return e.stop()}},e,null,[[2,7]])}))).apply(this,arguments)}function Se(){document.getElementById("new-password").addEventListener("input",function(){clearTimeout(he),he=p()(Ie,300)}),document.getElementById("confirm-password").addEventListener("input",function(){clearTimeout(he),he=p()(Ie,300)})}function Ae(){return Te.apply(this,arguments)}function Te(){return(Te=(0,o.A)(c().mark(function e(){var t,n,r,a,s,o,i,l,d,p;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u()(t=document.getElementById("login-email").value).call(t),r=document.getElementById("login-password").value,document.getElementById("login-error"),Oe(),n&&r){e.next=1;break}return Me("Please enter both email/manifesto and password"),e.abrupt("return");case 1:if(e.prev=1,a=n,O()(n).call(n,"@")){e.next=4;break}return e.next=2,supabase.from("profiles").select("email").eq("manifesto",n).single();case 2:if(s=e.sent,o=s.data,!s.error&&o){e.next=3;break}return Me("Manifesto not found. Please check your manifesto or use your email instead."),e.abrupt("return");case 3:a=o.email;case 4:return e.next=5,supabase.auth.signInWithPassword({email:a,password:r});case 5:if(i=e.sent,i.data,!(l=i.error)){e.next=6;break}O()(d=l.message).call(d,"Invalid login credentials")?Me("Invalid credentials. Please check your password."):O()(p=l.message).call(p,"Email not confirmed")?Me("Please verify your email address first."):Me("Login failed: "+l.message),e.next=7;break;case 6:return Oe(),me(),e.next=7,J();case 7:e.next=9;break;case 8:e.prev=8,e.catch(1),Me("An error occurred during login. Please try again.");case 9:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}function Me(e){var t=document.getElementById("login-error");t&&(t.textContent=e,t.style.display="block",t.style.opacity="0",p()(function(){t.style.opacity="1"},10))}function Oe(){var e=document.getElementById("login-error");e&&(e.style.display="none",e.textContent="")}function Pe(){var e=document.getElementById("login-email"),t=document.getElementById("login-password");e&&(e.addEventListener("blur",function(){var e,t=function(e){if(!u()(e).call(e))return{valid:!1,message:"Please enter your email or manifesto"};if(O()(e).call(e,"@")&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return{valid:!1,message:"Please enter a valid email address"};return{valid:!0}}(this.value);!t.valid&&u()(e=this.value).call(e)&&Me(t.message)}),e.addEventListener("input",function(){Oe()})),t&&t.addEventListener("input",function(){Oe()})}function _e(){return(_e=(0,o.A)(c().mark(function e(){var t,n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,supabase.auth.signOut();case 1:if(t=e.sent,!(n=t.error)){e.next=2;break}throw n;case 2:return e.next=3,J();case 3:e.next=5;break;case 4:e.prev=4,e.catch(0);case 5:case"end":return e.stop()}},e,null,[[0,4]])}))).apply(this,arguments)}document.addEventListener("DOMContentLoaded",(0,o.A)(c().mark(function e(){var t,n,r,a,s,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,J();case 1:if(t=window.location.hash,!O()(t).call(t,"access_token")&&!O()(t).call(t,"refresh_token")){e.next=6;break}return e.prev=2,e.next=3,supabase.auth.getSession();case 3:n=e.sent,r=n.data,n.error||r.session&&(a=new(T())(window.location.search),s="password_update"===a.get("type"),o=a.get("email"),s&&o&&ke(decodeURIComponent(o))),e.next=5;break;case 4:e.prev=4,e.catch(2);case 5:window.history.replaceState({},"",window.location.pathname);case 6:be(),Se();case 7:case"end":return e.stop()}},e,null,[[2,4]])}))),document.addEventListener("DOMContentLoaded",function(){Pe()}),document.addEventListener("click",function(e){var t=document.querySelector(".user-menu"),n=document.getElementById("user-dropdown");t&&!t.contains(e.target)&&n&&(n.style.display="none")}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("auth-modal"),t=document.querySelector(".auth-modal-container");function n(){e&&(e.style.display="none",ye(),document.documentElement.classList.remove("lock"))}document.addEventListener("click",function(e){return e.target.closest(".user-menu-trigger")?(e.preventDefault(),void("none"===(t=document.getElementById("user-dropdown")).style.display||""===t.style.display?t.style.display="block":t.style.display="none")):e.target.closest(".logout-btn")?(e.preventDefault(),void function(){_e.apply(this,arguments)}()):void 0;var t}),e&&t&&(e.addEventListener("click",function(t){t.target===e&&n()}),t.addEventListener("click",function(e){e.stopPropagation()})),document.addEventListener("click",function(t){var n=t.target.closest("#login-trigger"),r=t.target.closest(".header__nav--mobile span");if(n||r)return t.preventDefault(),e&&(e.style.display="block",document.documentElement.classList.add("lock")),void closeMobileMenu();if(t.target.closest(".header__mob-toggle")){var a=document.getElementById("mobileNav");a&&(a.style.display="block"===a.style.display?"none":"block")}});var r=document.getElementById("login-button");r&&r.addEventListener("click",Ae);var a=document.querySelector(".auth-form-toggle.signup");a&&a.addEventListener("click",ve);var s=document.getElementById("signup-button");s&&s.addEventListener("click",ce);var o=document.querySelector("#signup-form .auth-form-toggle");o&&o.addEventListener("click",ge);var i=document.querySelector(".forgot-password-link");i&&i.addEventListener("click",fe);var c=document.getElementById("reset-link");c&&c.addEventListener("click",Ee);var l=document.querySelector("#password-reset-form .auth-form-toggle");l&&l.addEventListener("click",ge);var u=document.getElementById("update-password");u&&u.addEventListener("click",Le);var d=document.getElementById("resend-button");d&&d.addEventListener("click",de);var p=document.getElementById("verify-button");p&&p.addEventListener("click",n);var m=document.getElementById("manifesto");m&&m.addEventListener("input",X);var y=document.getElementById("signup-email");y&&y.addEventListener("input",ne);var f=document.getElementById("signup-password");f&&f.addEventListener("input",oe)}),"undefined"!=typeof window&&(window.displayUserProfile=K,window.generateBarcode=R,window.barcodeGenerator=$)}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={exports:{}};return t[e].call(s.exports,s,s.exports,r),s.exports}r.m=t,e=[],r.O=(t,n,a,s)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,a,s]=e[u],i=!0,c=0;c<n.length;c++)(!1&s||o>=s)&&Object.keys(r.O).every(e=>r.O[e](n[c]))?n.splice(c--,1):(i=!1,s<o&&(o=s));if(i){e.splice(u--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,a,s]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.j=682,(()=>{var e={682:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,s,[o,i,c]=n,l=0;if(o.some(t=>0!==e[t])){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(c)var u=c(r)}for(t&&t(n);l<o.length;l++)s=o[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.O(void 0,[96,869,828],()=>r(96443)),r.O(void 0,[96,869,828],()=>r(30001)),r.O(void 0,[96,869,828],()=>r(15230));var a=r.O(void 0,[96,869,828],()=>r(45828));a=r.O(a)})();