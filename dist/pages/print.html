<style data-page="print">* {
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }
    
    
    
      
    
            .library-items {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
                list-style-type: none;
               
            }
    

                 .book-items {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(500px, 2fr));
                gap: 20px;
                list-style-type: none;
         
               
            }

          .library-items li, .book-items li {
    position: relative;
    border: 2px solid black;
    overflow: hidden;
    cursor: pointer;
    background: white;

    height: auto; /* 改为 auto */
    display: flex; /* 添加 flex 布局 */
    flex-direction: column; /* 垂直排列 */
}
    
          .library-items img{
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;
    aspect-ratio: 1 / 1;
   height: calc(100% - 50px);
}

    
         .overlay {
    position: relative;
    padding: 10px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    border-top: 2px black solid;
    /* 添加 flex-grow 填充剩余空间 */
    flex-grow: 1;
}

    
            .title {
                font-size: 18px;
                margin-bottom: 5px;
            }
    
            .price {
                font-size: 15px;
                color: black;
            }
    
            /* 添加更多商品项的演示样式 */
            .placeholder-img {
                width: 100%;
                height: 200px;
                display: flex;
                align-items: center;
                justify-content: center;
            
                font-size: 24px;
            }
            .retro-console {
                border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
            }
            .library{
                border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
            }
            .taobao{
                margin-top: 20px;
                border: 2px black solid;
                padding: 5px;
            }
          .books{
            margin-top: 20px;
            border: 2px black solid;
                padding: 5px;
                margin-bottom: 20px;
          }

    .description{
    font-size: 15px;
    }
    

    .book-items li {
    height: 350px;
     display: flex;
    flex-direction: column;
}

.book-items img {
    width: 100%;
    height: auto;
    object-fit: cover;
    display: block;

    flex: 1 1 auto; /* 关键：允许图片伸缩 */
    min-height: 40%; /* 最小占 40% */
    max-height: 75%; /* 最大占 70% */
}

/* 文字区域 - 自动调整 */
.book-items .overlay {
    flex: 1 1 auto; /* 关键：允许文字区域伸缩 */
    
    border-top: 2px black solid;
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* 文字从顶部开始 */
  
}

/* description 确保文字完全显示 */
.book-items .description {
    height: auto;
    min-height: 0; /* 重要：允许压缩 */
    flex: 1; /* 填充可用空间 */
    display: flex;
    flex-direction: column;
}

.book-items .meta {
    flex: 1; /* 文字填充剩余空间 */

    font-style: italic;
}
            @media(max-width:899px) {
             
                .library-items {
     
                    display: grid;
            grid-template-columns: repeat(2,  1fr);
            
            gap: 10px;
            list-style-type: none;}

    .book-items {
                    display: grid;
            grid-template-columns: repeat(1,  1fr);
            gap: 10px;
            list-style-type: none;}
    
            .library{
             
                margin-bottom: 10px;
            }
            .books{
            margin-top: 10px;
                margin-bottom: 10px;
          }
          .book-items{
            gap: 10px;
          }
        }</style><link href="/css/styles.ffe12bf25f15d90e6cb1.css" rel="stylesheet"><body><div class="library"><h1>Home Library</h1><p>My personal library — feel free to read and scan in-house</p></div><div class="section"><ul class="library-items"><li data-id="game" data-type="library"><img src="/images/library/001.png" width="250px"><div class="overlay"><span class="title">GAME</span></div></li><li data-id="culture" data-type="library"><img src="/images/library/004.png" width="250px"><div class="overlay"><span class="title">CULTURE</span></div></li><li data-id="design" data-type="library"><img src="/images/library/002.png" width="250px"><div class="overlay"><span class="title">DESIGN</span></div></li><li data-id="law" data-type="library"><img src="/images/library/003.png" width="250px"><div class="overlay"><span class="title">LAW</span></div></li></ul></div><div class="books"><h1>Self-Published Books</h1><p>Using home printers to produce compact books of all kinds — from chapbooks to catalogs and handy guides</p></div><div class="section"><ul class="book-items"><li data-id="ground-ip" data-type="book"><img src="/images/library/005.png" width="250px"><div class="overlay"><div class="description"><span class="title">GROUND IP</span> <span class="meta">Presenting the historical and logical framework of intellectual property through self-published manuals, grounded in lived experience.</span></div></div></li><li data-id="comics" data-type="book"><img src="/images/library/005.png" width="250px"><div class="overlay"><span class="title">COMICS</span></div></li></ul></div><script defer="defer" src="/js/vendors.515c171d2c3970a6f856.js"></script><script defer="defer" src="/js/styles.ce885c7f7bfcf71c21e1.js"></script><script defer="defer" src="/js/global.658f7018f35d524f3c6a.js"></script></body><script>(function() {
            console.log('[Library] Page script starting at:', new Date().toISOString());
            
            // 使用唯一的命名空间避免冲突
            const NAMESPACE = 'libraryPage_' + Date.now();
            
            // 防抖时间戳
            let lastClickTime = 0;
            const CLICK_DEBOUNCE_TIME = 300; // 300ms防抖
            
            // 清理函数
            function cleanupLibraryPage() {
                console.log('[Library] Cleaning up...');
                
                // 移除所有事件监听器
                const containers = document.querySelectorAll('.library-items, .book-items');
                containers.forEach(container => {
                    const newContainer = container.cloneNode(true);
                    container.parentNode.replaceChild(newContainer, container);
                });
                
                // 清理全局变量
                if (window[NAMESPACE]) {
                    delete window[NAMESPACE];
                }
                delete window.cleanupLibraryPage;
            }
            
            // 立即注册清理函数
            window.cleanupLibraryPage = cleanupLibraryPage;
            
            // 先清理旧的实例
            const existingCleanup = Object.keys(window).find(key => 
                key.startsWith('libraryPage_') && key !== NAMESPACE
            );
            if (existingCleanup) {
                delete window[existingCleanup];
            }
            
            // 处理项目点击 - 优化版本
            function handleItemClick(e) {
                const currentTime = Date.now();
                
                // 防抖检查
                if (currentTime - lastClickTime < CLICK_DEBOUNCE_TIME) {
                    console.log('[Library] Click ignored - too fast');
                    return;
                }
                
                const item = e.target.closest('.library-item, .book-item, li[data-id]');
                if (!item) {
                    return;
                }
                
                // 立即阻止事件传播
                e.preventDefault();
                e.stopPropagation();
                e.stopImmediatePropagation();
                
                // 更新防抖时间戳
                lastClickTime = currentTime;
                
                // 获取项目数据
                const itemId = item.getAttribute('data-id');
                const itemType = item.getAttribute('data-type');
                
                console.log('[Library] Item clicked:', itemId, itemType);
                
                try {
                    // 清理当前页面
                    if (window.cleanupLibraryPage) {
                        window.cleanupLibraryPage();
                    }
                    
                    // 根据ID导航到对应页面
                    if (itemId === 'law') {
                        // 在导航前先清理 law 页面的旧状态
                        if (window.cleanupLawPage) {
                            window.cleanupLawPage();
                        }
                        
                        if (window.router && window.router.navigate) {
                            window.router.navigate('law');
                        } else if (typeof window.loadPage === 'function') {
                            window.loadPage('law');
                        }
                    } else if (itemId === 'culture') {
                        // 在导航前先清理 culture 页面的旧状态
                        if (window.cleanupCulturePage) {
                            window.cleanupCulturePage();
                        }
                        
                        if (window.router && window.router.navigate) {
                            window.router.navigate('culture');
                        } else if (typeof window.loadPage === 'function') {
                            window.loadPage('culture');
                        }
                    } else if (itemId === 'game') {
                        // 在导航前先清理 game 页面的旧状态
                        if (window.cleanupGamePage) {
                            window.cleanupGamePage();
                        }
                        
                        if (window.router && window.router.navigate) {
                            window.router.navigate('game');
                        } else if (typeof window.loadPage === 'function') {
                            window.loadPage('game');
                        }
                    } else if (itemId === 'design') {
                        // 在导航前先清理 design 页面的旧状态
                        if (window.cleanupDesignPage) {
                            window.cleanupDesignPage();
                        }
                        
                        if (window.router && window.router.navigate) {
                            window.router.navigate('design');
                        } else if (typeof window.loadPage === 'function') {
                            window.loadPage('design');
                        }
                    } else {
                        // 其他项目导航到通用详情页（如果需要）
                        console.log(`Navigate to ${itemId} page (not implemented yet)`);
                    }
                    
                } catch (error) {
                    console.error('[Library] Navigation error:', error);
                }
            }
            
            // 初始化
            function initLibraryPage() {
                console.log('[Library] Initializing...');
                
                // 确保DOM完全就绪
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', () => {
                        setTimeout(initLibraryPage, 100);
                    });
                    return;
                }
                
                // 获取所有项目容器
                const libraryContainer = document.querySelector('.library-items');
                const bookContainer = document.querySelector('.book-items');
                
                if (!libraryContainer) {
                    console.error('[Library] Library container not found');
                }
                
                if (!bookContainer) {
                    console.error('[Library] Book container not found');
                }
                
                // 存储处理器引用
                window[NAMESPACE] = { handleItemClick };
                
                // 使用事件委托，在冒泡阶段处理（false参数）
                if (libraryContainer) {
                    libraryContainer.addEventListener('click', handleItemClick, false);
                    console.log('[Library] Event listener attached to library items');
                }
                
                if (bookContainer) {
                    bookContainer.addEventListener('click', handleItemClick, false);
                    console.log('[Library] Event listener attached to book items');
                }
                
                // 重置防抖时间戳
                lastClickTime = 0;
            }
            
            // 确保 DOM 加载完成后初始化
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initLibraryPage);
            } else {
                initLibraryPage();
            }
            
            // 调试信息
            console.log('[Library] Script complete');
        })();</script>